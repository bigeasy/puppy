#!/bin/bash

cd $(dirname $0)
cd ../..

echo "Generating file contexts."
bin/selinux/fcgen

echo "Building policy."
pushd selinux > /dev/null
output=$(/usr/bin/make -f /usr/share/selinux/devel/Makefile)
if [ $? -eq 0 ]
then
    echo "Reloading policy."
    /usr/bin/sudo /usr/sbin/semodule -i *.pp 
else
    echo $output
    exit 1
fi
popd > /dev/null
