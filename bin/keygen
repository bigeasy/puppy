#!/bin/bash

if [ $(whoami) != "root" ]
then
    echo "Must run as root." 2>&1
    exit 1
fi

if [ -e /home/enqueue/.ssh/identity ]; then
    echo "Identity private key already exists." 2&>1
    exit 1
fi

if [ -e /home/enqueue/.ssh/identity.pub ]; then
    echo "Identity public key already exists." 2&>1
    exit 1
fi

/usr/bin/sudo -u enqueue /usr/bin/ssh-keygen -C enqueue -t rsa -f /home/enqueue/.ssh/identity -N ''

/sbin/restorecon -R /home/enqueue
