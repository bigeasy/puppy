#!/bin/bash

users=$(sudo /usr/sbin/semanage login -l | awk '/^[a-z]/ { print $1 }')

function assign_profile()
{
    user=$1
    echo users | grep user
    if [ $? -ne 0 ]
    then
        echo "Assigning profile "$user"_u to user $user"
    fi
}

mapped=$(/usr/bin/sudo /usr/sbin/semanage login -l | /bin/sed 1,3d | /bin/awk '{ print $1 }')
for user in public
do
    echo "$mapped" | grep '^'$user'$' > /dev/null
    if [ $? -ne 0 ]
    then
        echo "Mapping user $user to ${user}_u."
        sudo semanage login -a -s $user'_u' $user
    fi
done

for user in protected liminal
do
    echo "$mapped" | grep '^%'$user'$' > /dev/null
    if [ $? -ne 0 ]
    then
        echo "Mapping group $user to ${user}_u."
        /usr/bin/sudo /usr/sbin/semanage login -a -s $user'_u' '%'$user
    fi
done
