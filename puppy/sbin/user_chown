#!/bin/bash

. /puppy/bin/functions

[ $# -lt 1 ] && abend "Incorrect count of arguments ($#)."

uid=$1
assert_valid_user $uid
assert_valid_home_dir $uid

gid=$(/bin/awk -F':' '$3 ~ /'$uid'/ { print $4 }'  /etc/passwd)

if [ $# -eq 1 ]; then
    /bin/chown -R $uid:$gid /home/u$uid
else
    shift
    while [ $# -gt 0 ]; do
        path=$1
        file=$(/bin/readlink -f /home/u$uid/$path)
        if [[ $file == /home/u$uid/* ]]; then
            /bin/chown -R $uid:$gid /home/u$uid/$path
        else
            abend "Invalid home directory path $1."
        fi
        shift
    done
fi
